<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
	<head>
		<title>FRENDS Radon Tutorial</title>
		<style type="text/css">
			body { font-family: Verdana; font-size:small; margin: 0px 0px 40px 40px;}
			pre.code {color: #800000; font-size:medium;}
			dt {font-style: italic;	}
			.filter {font-family: Monospace; font-size:medium;}			
			.filename {font-family: Monospace; font-size:medium;}	
			th {border-bottom: 2px solid black; padding: 10px;}
			td {border-bottom: 1px solid black; padding: 8px;}
			.eula {width:40em; font-family: Monospace; font-size:medium;}
			li { margin-top: 1mm; margin-bottom: 2mm; } 
			li.contents { margin-top: 2mm; margin-bottom: 2mm; font-weight:bold;}
		</style>
	</head>
	<body>
	<img src="Images/FRENDS_logo.png" alt="Frends Technology logo"/>
	<h1>FRENDS RADON TUTORIAL</h1>
	
	<h2>CONTENTS</h2>	
		<ul>
			<li class="contents"><a href="#introduction">INTRODUCTION</a></li>
			<li class="contents"><a href="#prerequisites">PREREQUISITES</a>			
				<ul>
					<li class="contents"><a href="#ironInstalled">FRENDS Iron installed</a></li>
					<li class="contents"><a href="#radonConfigured">FRENDS Iron is configured with FRENDS Radon</a></li>
				</ul>
			</li>
			<li class="contents"><a href="#configureSample">CONFIGURING AND RUNNING A SAMPLE EVENT REPORT</a>			
				<ul>
					<li class="contents"><a href="#setupSMTP">Setup a SMTP server and an email account</a></li>
					<li class="contents"><a href="#createTask">Create a new task for event reporting</a></li>
					<li class="contents"><a href="#createConnectionPoint">Create a new connection point for event report parameters</a></li>
					<li class="contents"><a href="#createRoutine">Create a new routine to run the event report</a></li>
					<li class="contents"><a href="#runRoutine">Run the routine</a></li>
				</ul>
			</li>
			<li class="contents"><a href ="#versionHistory">VERSION HISTORY</a></li>
		</ul>

	<hr/>
	<h2><a name="introduction">INTRODUCTION</a></h2>
	<p>
	FRENDS Radon is a Windows Workflow Foundation (WF) solution built on top of FRENDS Iron for monitoring Windows event logs and sending monitor report forward by SMTP. FRENDS Radon can read and filter event logs from local Windows machine and from a remote Windows machine as well.
	This tutorial will show how to set up FRENDS Radon error reporting  and send it forward via email.	
	</p>
	<hr/>
	<h2><a name="prerequisites">PREREQUISITES</a></h2>
	<p>
	
	</p>
	<h3><a name="ironInstalled">FRENDS Iron installed</a></h3>
	<p>
	Because FRENDS Radon is a WF workflow running on top of FRENDS Iron, Iron needs to be installed and configured before Radon. 
	</p>
	<p>
	For details on how to install FRENDS Iron, see the FRENDS Iron documentation and readme.	
	</p>
	<h3><a name="radonConfigured">FRENDS Iron is configured with FRENDS Radon</a></h3>
	<p>
	When you configure FRENDS Iron, the FRENDS Radon routine elements and assemblies will be automatically deployed and configured by default. The <b>FRENDS Radon Sample</b> should be shown in the routine list. 	
	</p>
	<p>
	If the routine is not in the list, please see the Radon help on details how to configure FRENDS Iron with the FRENDS Radon sample routine and routine elements.
	</p>
	<hr/>
	<h2><a name="configureSample">CONFIGURING AND RUNNING A SAMPLE EVENT REPORT</a></h2>
	<p>
	First step is to configure the sample event reporting. We will set up reporting from a local Windows machine.
	</p>
	<h3><a name="setupSMTP">Setup a SMTP server and an email account</a></h3>
	<p>
	For this tutorial, and using FRENDS Radon in any case, you need to setup an SMTP server (or use any existing STMP server available for you) in order to be able to send the FRENDS Radon event reports forward. For completing this tutorial you need to know at least the following details of the SMTP server: 
	</p>
	<ul>
		<li>SMTP server name or its IP address.</li>
		<li>Outgoing SMTP port number.</li>
	</ul>
	
	<p>
	Depending on the SMTP server’s configuration you may also need these following details:
	</p>
	<ul>
		<li>Username and password for SMTP authentication. If your SMTP server does not 
            allow anonymous logins, you will need to give a username and password for sending 
            the emails.</li>
	</ul>	
	
	<h3><a name="createTask">Create a new task for event reporting</a></h3>
	<p>
	First, create a new task in FRENDS Iron that executes the FRENDS Radon event reporting workflow with given parameters.
	</p>
	
	<ol>
		<li>Open the <b>FRENDS Iron management console</b> and navigate to FRENDS Iron -> Routine elements -> Tasks<p><img src="Images/tasks.png" alt="FRENDS Iron tasks"/></p></li>
		<li>Right click on top of Tasks and select <b>Create new</b>. The Task property dialog opens.</li>
		<li>Name the Task <b>FRENDS Radon</b></li>
		<li>Click <b>Browse</b> button to navigate to workflow assemby file. By default, the FRENDS Radon assembly file <b>Frends.Radon.WF.dll</b> can be found in FRENDS Radon installation directory (default: \Program Files\Frends Technology\FRENDS Radon\FRENDSIronExample).</li>
		<li>From the <b>Workflow Class</b> dropdown menu, select <b>Frends.Radon.WF.RadonWF.</b><p><img src="Images/task.png" alt="Create Radon task"/></p></li>
		<li>Click <b>Parameters</b> tab.</li>
		<li>Select all properties except <i>Success</i>, <i>UserResultMessage</i> and <i>ActionSkipped</i><p><img src="Images/taskParameters.png" alt="FRENDS Radon task parameters"/></p></li>
		<li>Click OK</li>
	</ol>
	
	<h3><a name="createConnectionPoint">Create a new connection point for event report parameters</a></h3>
	<p>
	Next, we need to create a FRENDS Iron connection point for the reporting parameters. 
        You can also use the <b>FRENDS Radon Sample CP</b> sample connection point, if 
        it was imported during the FRENDS Iron configuration.
	</p>
	<ol>
	<li>In the FRENDS Iron management console navigate to FRENDS Iron -> Routine elements -> Connection points.<p><img src="Images/connectionPoints.png" alt="Connection points"/></p></li>
	<li>Right click on top of Connection Points and select <b>Add new Connection Point</b>. The Connection point property dialog opens.</li>
	<li>Name the connection point <b>FRENDS Radon Sample CP</b></li>
	<li>Click <b>Load Schema</b> button to choose a connection point schema.</li>
	<li>Select <b>FRENDSRadon-CPSchema.xsd</b> from list of schemas – if it is not found, you can browse for it under the FRENDS Radon installation folder, by default: \Program Files\Frends Technology\FRENDS Radon\FRENDSIronExample <p><img src="Images/connectionPointSchema.png" alt="Connection point schema"/></p></li>
	<li>Click OK to use the schema. The connection point properties dialog shows the RadonParameters structure.</li>
	<li>Configure the Filter parameters as in figure below: 
		<ul>
			<li><b>filterString</b> – The rules for selecting which events to report. Type <b>EntryType = "Error"</b> to report only those event which has error level of "Error". See <a href="manual.htm#filterString">FRENDS Radon manual</a> for more details on filter strings.</li>
			<li><b>maxTimeSpan</b> – Type <b>03:00:00</b> to report events for the past three hours.</li>
			<li><b>maxMessages</b> – Type <b>100</b> to get the latest 100 errors, should there be that much errors.</li>
			<li><b>remoteMachine</b> - Leave empty to read local machine's event log.</li>
			<li><b>eventLogName</b> - Leave empty to read Application event log</li>
		</ul>
		<p><img src="Images/filterParameters.png" alt="Filter parameters"/></p>
	</li>
	<li>Configure the SMTP parameters to match your SMTP server configuration: 	
		<ul>
			<li><b>smtpServerName</b> – Enter here your SMTP server name or its IP address.</li>
			<li><b>portNumber</b> – Enter here the outgoing mails port number for you SMTP server.</li>
			<li><b>subject</b> – Text that appears in an email subject. Type <b>FRENDS Radon system event report</b>.</li>
			<li><b>senderName</b> – Name that appears as sender in email. Type <b>FRENDS Radon Event Notifier</b>.</li>
			<li><b>senderAddress</b> – Text that appears as sender address in email. Type <b>radon.service@example.org</b>. </li>
			<li><b>recipients</b> – Recipients for email event report sent by FRENDS Radon. Enter your email address here. </li>
			<li><b>useWindowsCredentials</b> – Should the currently logged user’s credentials be used for SMTP server connection, if authentication is required by the server.</li>
			<li><b>username</b> – Username for mail server if authentication is required by your SMTP server.</li>
			<li><b>password</b> – Password for STMP server user.</li>
		    <li><b>maxIdleTime</b> – The time in milliseconds how long connection to mail server can remain idle before timing it out. Set to <b>10 000</b>. </li>
            <li><b>templateFile</b> – Path to the email template file (if empty default template will be used). </li>
		</ul>
		<p><img src="Images/configParameters.png" alt="Config parameters"/></p>
	</li>
	</ol>
	
	<p>
	Now the needed settings are defined in the new connection point.  	
	</p>
        <h3><a name="createRoutine">Create a new routine to run the event report</a> task</h3>
	<p>
	In order to run the event reporting, you will need to create a routine for it. Also the ‘FRENDS Radon Sample’ sample routine can be used, which was created during FRENDS Iron configuration, if FRENDS samples were chosen to be imported.	
	</p>
	
	<ol>
		<li>In the FRENDS Iron Management Console, right-click on FRENDS -> Routines, and select <b>Add new Routine</b></li>
		<li>Name the routine as <b>FRENDS Radon Sample</b></li>
	    <li>Click Add button from <b>Routine Tasks</b> and choose <b>FRENDS Radon</b> Task from list and click ok.</li>
	    <li>Do not define a schedule or condition for the routine. We will run the event report manually for now.</li>

	    <li>Check the <b>Use Connection Points</b> check box, select the <b>Single Connection Point</b> radio button and then select <b>FRENDS Radon Sample CP</b> from the Connection Point drop down menu.<p><img src="Images/routine.png" alt="Routine"/></p></li>

		<li>Define the parameters for the task as in the figure.
            <br />
            In this example we use references to connection point parameters. You could give 
            the parameters directly here instead of the connection point, but then you would 
            not be able to reuse the settings in other routines or use connection point 
            groups for sending reports to multiple recipients at a time.
        </li>
		<li>Click OK</li>		
	</ol>
	
	<p>
	The Sample Radon routine is created, and we are now ready to execute the event report.
	</p>
	
	<h3><a name="runRoutine">Run the routine</a></h3>
	<p>
	Run the newly created routine: right-click on the <b>FRENDS Radon Sample</b> routine and choose <b>Run Once</b> from the menu.
	</p>
	<p>
	A new routine instance is created for the event reporting and you can monitor it’s execution in the routine instance view, as shown in the figure below. Successful event reports will have a green icon, and failed event reports will have a red icon.
	</p>
	<p>
	<img src="Images/routineInstances.png" alt ="Routine instances"/>
	</p>
	<p>
	If the reporting was executed successfully, you should receive an email containing error events from Windows application log for the past 3 hours. Go to your email inbox to see the event report. However, if the event reporting failed, check the Result message column – it will show the error details.
	</p>
	<hr/>
	<h2><a name="versionHistory">VERSION HISTORY</a></h2>
	<table>
		<thead>
			<tr><th>Date</th><th>Editor</th><th>Description</th></tr>
		</thead>
	    <tbody>
	        <tr><td>2013-01-09</td><td>Mikael Putkonen</td><td>Updated routine images.</td></tr>
	        <tr><td>2009-11-04</td><td>Jouko Holappa</td><td>Initial version. XHTML 1.0 validated.</td></tr>
	    </tbody>
	</table>	
	</body>
</html>