<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>FRENDS Radon Manual</title>
    <style type="text/css">
        body
        {
            font-family: Verdana;
            font-size: small;
            margin: 0px 0px 40px 40px;
        }
        pre.code
        {
            color: #800000;
            font-size: medium;
        }
        dt
        {
            font-style: italic;
        }
        .filter
        {
            font-family: Monospace;
            font-size: medium;
        }
        .filename
        {
            font-family: Monospace;
            font-size: medium;
        }
        th
        {
            border-bottom: 2px solid black;
            padding: 10px;
        }
        td
        {
            border-bottom: 1px solid black;
            padding: 8px;
        }
        .eula
        {
            width: 40em;
            font-family: Monospace;
            font-size: medium;
        }
        li.contents
        {
            margin-top: 2mm;
            margin-bottom: 2mm;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <img src="Images/FRENDS_logo.png" alt="FRENDS Technology logo" />
    <h1>
        FRENDS RADON DOCUMENTATION</h1>
    <h2>
        CONTENTS</h2>
    <ul>
        <li class="contents"><a href="#terms">TERMS OF DELIVERY AND USE</a></li>
        <li class="contents"><a href="#overview">OVERVIEW</a></li>
        <li class="contents"><a href="#schedule">SETTING FRENDS RADON TO RUN AS A SCHEDULED
            TASK WITH WINDOWS TASK SCHEDULER</a>
        </li>
        <li class="contents"><a href="#FrendsSchedule">SETTING FRENDS RADON TO RUN WITH FRENDS
            IRON</a></li>
        <li class="contents"><a href="#contents">CONFIGURATION FILE CONTENTS</a>
            <ul>
                <li class="contents"><a href="#descriptions">Configuration element descriptions</a></li>
            </ul>
        </li>
        <li class="contents"><a href="#filterString">FILTER STRINGS</a></li>
        <li class="contents"><a href="#template">EMAIL TEMPLATES</a></li>
        <li class="contents"><a href="#externalEvents">EXTERNAL EVENTS</a></li>
        <li class="contents"><a href="#mailer">MAILER SIMPLE TASK</a></li>
    </ul>
    <hr />
    <h2>
        <a name="terms">TERMS OF DELIVERY AND USE</a></h2>
    <div class="eula">
        <p>
            These Terms of Delivery and Use (“Terms”) shall apply to FRENDS Radon software in
            object code form and any related documentation (“Product”) ordered and delivered
            to the licensee (“you”) by Frends Technology Inc (“FRENDS”).
        </p>
        <p>
            You agree to be legally bound by these Terms by selecting the accepting option below
            or by using the Product. If you do not agree to these Terms, do not download or
            use the Product.</p>
        <h3>
            General</h3>
        <p>
            You may download an evaluation version of the Product, in which case you are entitled
            only to evaluate the Product before purchasing a commercial version of the Product.
            When you download and purchase the commercial version of the Product, you shall
            first pay an applicable license fee with your credit card or other payment methods
            available. After the due payment, FRENDS shall deliver you a registration code,
            which enables the operation of the Product.
        </p>
        <p>
            It is important, and therefore you represent and warrant, that the identification
            and contact information you have provided to FRENDS in connection with your order
            for the Product is accurate and complete. Otherwise FRENDS may not be able to verify
            your payments and deliver you the necessary registration code. All identification
            and contact information will be subject to the privacy policy of FRENDS.</p>
        <p>
            You shall be responsible for acquiring at your own expense all necessary software,
            equipment and telecommunications for using the Product.</p>
        <p>
            The Product is neither intended nor fit for the use of consumers but companies only.
            Furthermore, the Product is not designed to be fault-tolerant and therefore it is
            not intended for use in hazardous environments that require fail-safe performance,
            such as in connection with life critical applications and systems.</p>
        <h3>
            Licenses of Evaluation Version and Commercial Version</h3>
        <p>
            You have a limited, non-exclusive and non-transferable right to install and use
            one (1) copy of the Product on one (1) server or workstation.</p>
        <p>
            If you have downloaded an evaluation version of the Product, you are entitled to
            use the Product, free-of-charge, strictly for the sole purpose of evaluating the
            features and usability of the Product, during a period of thirty (30) days from
            the day you downloaded the Product.</p>
        <p>
            If you have downloaded a commercial version of the Product, you are entitled to
            use the Product, subject to the payment of an applicable license fee, strictly for
            your internal business purposes only.</p>
        <p>
            In addition, you shall not (i) make other one (1) back-up copy, modify, work around
            any technical limitations, decompile, disassemble, reverse-engineer, or create derivative
            works based on, the Product; or (ii) assign, transfer, sublicense, rent, or otherwise
            distribute or make available, the Product or your limited right to use the Product;
            save to the extent that otherwise expressly provided for by mandatory provisions
            of applicable law.</p>
        <h3>
            No Warranty, New Delivery</h3>
        <p>
            The Product is licensed strictly “AS IS” without any warranty, express or implied,
            whatsoever, including but without limitation to warranties of merchantability, fitness
            for any particular purpose, performance or non-infringement. You shall assume the
            entire risk for your use of the Product. FRENDS shall have no obligation to provide
            you with maintenance, support or other consulting services, or upgrades of the Product.</p>
        <p>
            However, if you have downloaded, and duly paid for, the commercial version of the
            Product, but there have been errors in the transmission that prevent the operation
            of the Product, and you are not able to reload the Product, you should inform FRENDS
            without delay. FRENDS shall then make the Product available for a new downloading
            over Internet, or send the Product via email or ordinary mail to you. In case of
            an ordinary mail, you shall bear the costs of shipping.</p>
        <h3>
            Property Rights and Confidentiality</h3>
        <p>
            Title, ownership and all intellectual property rights to the Product belong exclusively
            to FRENDS or any supplier of FRENDS. You are granted only a limited right to use
            the Product.</p>
        <p>
            Aspects of the Product, including the specific design and structure, and registration
            codes enabling the use of the Product, are confidential and trade secrets of FRENDS
            or any supplier of FRENDS. You shall maintain such information as strictly confidential,
            and shall not disclose them to any third party or use them for any unauthorized
            purpose.</p>
        <h3>
            Limited Liability</h3>
        <p>
            Due to the fact that the Product is licensed to you strictly on an “AS IS” basis
            without any warranty, to the maximum event permitted by the applicable law neither
            FRENDS nor any supplier of FRENDS shall be liable for any damages whatsoever, including
            but without limitation to direct, indirect, special, consequential, punitive or
            incidental damages, and loss of revenue, profit or data. In any case the maximum
            liability of FRENDS shall be EUR 100.00. These limitations of liability constitute
            an essential part of these Terms. However, should your authorized use of the Product
            violate any third party intellectual property rights, FRENDS shall compensate you
            for the license fee you have paid provided that you inform FRENDS of the suspected
            or actual violation without undue delay and discontinue the use of the Product.</p>
        <h3>
            Laws and Forum</h3>
        <p>
            This Agreement shall be governed by substantial laws of Finland. Any and all disputes
            arising out of these Terms shall be intended to be settled amicably. In case an
            amicable settlement is not reached, the dispute shall be submitted to the District
            Court of Helsinki, Finland.</p>
        <p>
            Please note that you must use the Product in compliance with applicable export and
            import laws, regulations and rules, if any.
        </p>
        <h3>
            Termination of License</h3>
        <p>
            Each license to the Product shall terminate immediately and without notice in case
            you are in breach of these Terms, with the exception of such provisions that by
            their nature are intended to survive the termination of these Terms. Furthermore,
            FRENDS shall not be obligated to refund the license fee to you.</p>
        <h3>
            Entire Agreement, Amendments</h3>
        <p>
            These Terms constitute the entire agreement between you and FRENDS, and shall supersede
            any previous written or oral agreements and understandings, in relation to the subject
            matter of these Terms. Any and all amendments to these Terms shall be made in writing
            and expressly accepted by both you and FRENDS.</p>
    </div>
    <hr />
    <h2>
        <a name="overview">OVERVIEW</a></h2>
    <p>
        FRENDS Radon is a light-weight tool that emails reports from events in Windows application
        event log.
        <br />
    </p>
    <p>
        FRENDS Radon works on Windows Server 2003 R2 / 2008 / 2012 and requires .NET Framework
        4.0 to run</p>
    <p>
        To run FRENDS Radon, you first need to configure it, telling which events to report
        and where to send the report to. This is done by creating a configuration file named
        <span class="filename">Frends.Radon.exe.config'</span> and placing it in the same
        folder as the executable (<span class="filename">Frends.Radon.exe</span>).
    </p>
    <p>
        FRENDS Radon tries to keep track of what events it has reported earlier. This is done by
        storing the timestamp and hash of the last reported event associated with a filter configuration in
        the Windows' <a href="http://msdn.microsoft.com/en-us/library/bdts8hk0(v=vs.80).aspx">Isolated storage</a>.
        Any changes to the filter configuration will reset the tracking information. The fields considered a part
        of the filter configuration are: <i>FilterString</i>, <i>TimeLimitFilter</i>, <i>MaxMessages</i>, 
        <i>RemoteMachine</i>, <i>EventLogName</i>. If the last reported event has been deleted, then Radon reports all
        events with the same or newer timestamp. The last reported event is saved only if sending the report mail succeeds.
    </p>
    <p>
        The included example configuration file <span class="filename">Frends.Radon.exe.exampleconfig</span>
        directs FRENDS Radon to create HTML error report of Windows application log events
        and then sends the error report by email. The sample configuration uses the following
        settings that should be changed:
    </p>
    <ul>
        <li>The email is sent to 'john.doe@somedomain.com' and to 'jane.doe@somedomain.com'.
        </li>
        <li>'smtp.somedomain.com' with port '25' is used as SMTP server for sending the event
            report.</li>
        <li>Default credentials (credentials of user logged on to machine) are being used with
            sending email.</li>
        <li>Email sender address is set to 'notification_noreply@somedomain.com', sender name
            is set to 'NotificationService' and email subject is 'System event report'.</li>
        <li>All Error entries are reported, as described by the <a href="#filterString">filter
            string</a> <span class="filter">EntryType = "Error"</span></li>
    </ul>
    For more details on the configuration, see section <a href="#contents">Configuration
        file contents</a> below.
    <img src="Images/email.jpg" alt="Sample FRENDS Radon report" />
    Picture 1: Example of an error report generated and sent by FRENDS Radon.
    <hr />
    <h2>
        <a name="schedule">SETTING FRENDS RADON TO RUN AS A SCHEDULED TASK WITH WINDOWS TASK
            SCHEDULER</a></h2>
    <h3>
        <a name="server2003">On Microsoft Windows Server 2003</a></h3>
    <ul>
        <li>Click 'Start' menu -> Open 'Control Panel -> Open 'Scheduled Tasks' -> Select 'Add
            Scheduled Task'.</li>
        <li>In the opening 'Scheduled Task Wizard' click 'Next'.</li>
        <li>Select Program to be run: navigate to <span class="filename">Frends.Radon.exe</span>
            by clicking the 'Browse' button.</li>
        <li>Enter name for task and select when task is wanted to be run. Click 'Next'</li>
        <li>Enter start time and start date for task and whether the task is to be run every
            day, every weekday or with some other day interval. Click 'Next'.</li>
        <li>Enter username and password for user who is used to run the task. Click 'Next'.</li>
        <li>Click 'Finish'.</li>
    </ul>
    <p>
        Note that <span class="filename">Frends.Radon.exe</span> requires that the configuration
        file is placed in the same directory as the executable.</p>
    <h3>
        <a name="server2008">On Microsoft Windows Server 2008</a></h3>
    <ul>
        <li>Click 'Start' menu -> Open 'Control Panel -> Open 'Administrative Tools' -> Open
            'Task Scheduler'.</li>
        <li>Select 'Action' and then 'Create Task...' from menu bar or select 'Create Task...'
            from 'Actions' panel.</li>
        <li>Enter name for task and a description if you like to.</li>
        <li>Select 'Actions' tab and click 'New...'.</li>
        <li>Select Action: 'Start a program' and enter the location of <span class="filename">
            Frends.Radon.exe</span> in the 'Program/script:' textbox. You can also navigate
            to the <span class="filename">Frends.Radon.exe</span> file by clicking 'Browse'.</li>
        <li>On the 'Triggers' tab you can create schedules for task which control when the task
            will be run. New schedule is created by clicking 'New...'.</li>
        <li>Click 'OK' when you're done configuring the task.</li>
        <li>Select 'Task Scheduler Library' from the left navigation on 'Task Scheduler'. The
            task you created should now be shown on the task list.</li>
    </ul>
    <h3>
        <a name="server2012">On Microsoft Windows Server 2012</a></h3>
    <ul>
        <li>Click 'Start' menu -> Write 'Administrative Tools' -> Open Administrative Tools -> Open
            'Task Scheduler'.</li>
        <li>Select 'Action' and then 'Create Task...' from menu bar or select 'Create Task...'
            from 'Actions' panel.</li>
        <li>Enter name for task and a description if you like to.</li>
        <li>Select 'Actions' tab and click 'New...'.</li>
        <li>Select Action: 'Start a program' and enter the location of <span class="filename">
            Frends.Radon.exe</span> in the 'Program/script:' textbox. You can also navigate
            to the <span class="filename">Frends.Radon.exe</span> file by clicking 'Browse'.</li>
        <li>On the 'Triggers' tab you can create schedules for task which control when the task
            will be run. New schedule is created by clicking 'New...'.</li>
        <li>Click 'OK' when you're done configuring the task.</li>
        <li>Select 'Task Scheduler Library' from the left navigation on 'Task Scheduler'. The
            task you created should now be shown on the task list.</li>
    </ul>
    <hr />
    <h2>
        <a name="FrendsSchedule">SETTING FRENDS RADON TO RUN WITH FRENDS IRON</a></h2>
    <p>
        FRENDS Radon also comes as a FRENDS Iron Simple Task that can be
        run with FRENDS Iron, allowing more versatile scheduling and parameterization. The
        Simple Task version uses the same parameters as the standalone .exe version, with a
        few improvements.
    </p>
    <p>
        To set up the workflow with FRENDS Iron:</p>
    <ul>
        <li>As of FRENDS Iron version 2.4, FRENDS Radon samples can be imported during the FRENDS
            Iron Configuration process. For more information on the configuration process, see
            FRENDS Iron Configuration documentation. </li>
        <li><a name="ManualIronInstall" />FRENDS Radon samples can also be imported manually,
            if for some reason the samples don't exist or they have been deleted.
            <ul>
                <li>Copy the <span class="filename">Frends.Radon.Core.dll</span>, as well as the <span
                    class="filename">Frends.Radon.SimpleTask.dll</span> and <span class="filename">DotLiquid.dll</span>
                    files from the <span class="filename">FRENDSIronExample</span> directory to the
                    FRENDS Iron installation folder (by default under <span class="filename">\Program Files\Frends
                        Technology</span>)</li>
                <li>Import the ready-made 'FRENDS Radon Sample' routine from the <span class="filename">
                    FRENDSRadon-Routine.xml</span> file using the FRENDS Iron management console (see
                    FRENDS Iron documentation for details on the import process). Importing the routine
                    also imports the FRENDS Radon task.<br />
                    The routine has all the necessary parameters set up. It expects to get the entire
                    filter and mail sending configuration from a connection point, the 'FRENDS Radon
                    Sample CP' is included with the routine. To really use the workflow, you need to
                    create your own connection point, as the sample CP has the same dummy data as in
                    the sample configuration file.</li>
                <li>Create a new connection point using the ready-made schema <span class="filename">
                    FRENDSRadon-CPSchema.xsd</span> (again, see the FRENDS Iron documentation for more
                    details on this).
                    <br />
                    Assign this CP to the routine to run it. You can also create multiple CPs and create
                    a CP group from them to send out different email reports to multiple people</li>
                <li>To schedule the routine, just create a new schedule for it as described in the FRENDS
                    Iron documentation.</li>
            </ul>
        </li>
    </ul>
    <p>
        The parameters for the FRENDS Radon Simple Task are almost exactly the same as the
        parameters for the executable version, except for the names and external events support. The details for the
        parameters are described in section <a href="#descriptions">configuration element descriptions</a>;
        the links to individual parameter names and noteworthy differences are noted below:</p>
    <h3>
        Simple Task filter parameters</h3>
    <img src="Images/filterParameters.png" alt="CP dialog showing Radon filter parameters" />
    <dl>
        <dt>filterString</dt>
        <dd>
            See <a href="#Filter_FilterString">FilterString</a></dd>
        <dt>maxTimespan</dt>
        <dd>
            See <a href="#Filter_TimeLimitFilter">TimeLimitFilter</a></dd>
        <dt>maxMessages</dt>
        <dd>
            See <a href="#Filter_MaxMessages">MaxMessages</a></dd>
        <dt>remoteMachine</dt>
        <dd>
            See <a href="#Filter_RemoteMachine">RemoteMachine</a></dd>
        <dt>eventLogName</dt>
        <dd>
            See <a href="#Filter_EventLogName">EventLogName</a></dd>
    </dl>
    <h3>
        Simple Task config parameters</h3>
    <img src="Images/configParameters.png" alt="CP dialog showing Radon config parameters" />
    <dl>
        <dt>smtpServerName</dt>
        <dd>
            See <a href="#SMTP_SmtpServerName">SmtpServerName</a></dd>
        <dt>portNumber</dt>
        <dd>
            See <a href="#SMTP_PortNumber">PortNumber</a></dd>
        <dt>subject</dt>
        <dd>
            See <a href="#Email_Subject">Subject</a></dd>
        <dt>senderName</dt>
        <dd>
            See <a href="#Email_SenderName">SenderName</a></dd>
        <dt>recipients</dt>
        <dd>
            See <a href="#Email_Recipients">Recipients</a>.<br />
            NOTE: Several recipients must be delimited with a semicolon, e.g.:
            'john.doe@example.org;jane.doe@example.org'.</dd>
        <dt>useWindowsCredentials</dt>
        <dd>
            See <a href="#SMTP_UseWindowsCredentials">UseWindowsCredentials</a></dd>
        <dt>username</dt>
        <dd>
            See <a href="#SMTP_Username">Username</a></dd>
        <dt>password</dt>
        <dd>
            See <a href="#SMTP_Password">Password</a>.<br />
            NOTE: If you do not want the password shown in plain text in the UI, you can use
            encrypted CP fields. For more information on them, see the FRENDS Iron documentation.</dd>
        <dt>maxIdleTime</dt>
        <dd>
            See <a href="#SMTP_MaxIdleTime">MaxIdleTime</a></dd>
        <dt>templateFile</dt>
        <dd>See <a href="#Email_TemplateFile">TemplateFile</a></dd>
        <dt>useSsl</dt>
        <dd>See <a href="#SMTP_UseSSL">UseSsl</a></dd>
        <dt>eventSource</dt>
        <dd>See <a href="#Filter_EventSource">EventSource</a> (Not included in Connection Point, only in the Routine Task)</dd>
        <dt>externalEventsXml</dt>
        <dd>See <a href="#Filter_ExternalEventsXml">ExternalEventsXml</a> (Not included in Connection Point, only in the Routine Task)</dd>
    </dl>
    <h3>
        Updating FRENDS Radon on FRENDS Iron</h3>
    <p>
        Updating with the FRENDS Iron Configuration:</p>
    <ul>
        <li>Run FRENDS Iron Configuration</li>
        <li>Check the checkbox 'Import FRENDS Radon and FRENDS Cobalt sample routines and assemblies'
            box on the Service Configuration page</li>
        <li>You will be warned about overwriting the assemblies, read the warning and press
            yes</li>
        <li>The old assemblies will be overwritten and new tasks and connection points will
            be imported.</li>
        <li>If you have old versions of the Radon connection points, task or routine and wish
            to still use them, you need to update them manually</li>
    </ul>
    <p>
        Updating existing tasks manually:</p>
    <ul>
        <li>Update the connection points: Load the new schema and fill in the new parameters
            if needed</li>
        <li>Update the task from the Task properties:
            <ul>
                <li>reselect 'Workflow Assembly'</li>
                <li>reselect 'Workflow class' </li>
                <li>add the new 'Parameters' </li>
            </ul>
        </li>
        <li>Update the Routine's 'Task Arguments' from the Routine properties </li>
    </ul>
    <p>
        Refer to the <a href="FRENDSRadonTutorial.htm">FRENDSRadonTutorial.htm</a> for more
        information on how to accomplish the tasks above.</p>
    <p>
        The old tasks and connection points should work with the new assemblies. Note that
        when updating from versions prior to 1.3, you will have to update the task. This
        is because the assembly has been strong named and it cannot be referenced by previous
        assembly type name. You can fix this from the Radon task properties by reselecting
        the <code>Frends.Radon.WF.dll</code></p>
    <hr />
    <h2>
        <a name="contents">CONFIGURATION FILE CONTENTS</a></h2>
    <p>
        FRENDS Radon comes with a example configuration file <span class="filename">Frends.Radon.exe.exampleconfig</span>
        with the following contents:
    </p>
    <pre class="code">
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;configuration&gt;
    &lt;configSections&gt;
        &lt;sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" &gt;
            &lt;section name="Frends.Radon.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" /&gt;
        &lt;/sectionGroup&gt;
    &lt;/configSections&gt;
    &lt;applicationSettings&gt;
        &lt;Frends.Radon.Properties.Settings&gt;
        &lt;!-- Mail sending settings --&gt;
            &lt;setting name="SmtpServerName" serializeAs="String"&gt;
                &lt;value&gt;smtp.somedomain.com&lt;/value&gt;
            &lt;/setting&gt;
            
            &lt;setting name="PortNumber" serializeAs="String"&gt;
                &lt;value&gt;25&lt;/value&gt;
            &lt;/setting&gt;
            
        &lt;!-- Time in milliseconds the SMTP connection can be idle before it is closed --&gt;
            &lt;setting name="MaxIdleTime" serializeAs="String"&gt;
                &lt;value&gt;100000&lt;/value&gt;
            &lt;/setting&gt;
            
        &lt;!-- email address to be used as sender address 
        NOTE: Some SMTP servers filter the sent messages based on the sender address, so make sure your server accepts this address --&gt;
            &lt;setting name="SenderAddress" serializeAs="String"&gt;
                &lt;value&gt;notification_noreply@somedomain.com&lt;/value&gt;
            &lt;/setting&gt;
            
        &lt;!-- The email recipients --&gt;
            &lt;setting name="Recipients" serializeAs="Xml"&gt;
                &lt;value&gt;
                    &lt;ArrayOfString xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;
                        &lt;string&gt;john.doe@somedomain.com&lt;/string&gt;
                        &lt;string&gt;jane.doe@somedomain.com&lt;/string&gt;
                    &lt;/ArrayOfString&gt;
                &lt;/value&gt;
            &lt;/setting&gt;
            
        &lt;!-- Text to be displayed as email aubject --&gt;
            &lt;setting name="Subject" serializeAs="String"&gt;
                &lt;value&gt;System event report&lt;/value&gt;
            &lt;/setting&gt;
            
        &lt;!-- text to be displayed as email sender name --&gt;
            &lt;setting name="SenderName" serializeAs="String"&gt;
                &lt;value&gt;FRENDS Radon&lt;/value&gt;
            &lt;/setting&gt;
            
        &lt;!-- Some SMTP servers require mail clients to be authenticated. 
        If you set this setting true, the credentials for the user account running the exe will be provided. 
        If this is false, the Username and Password settings below are used. If those are left empty, the email is sent anonymously.--&gt;
        &lt;setting name="UseWindowsCredentials" serializeAs="String"&gt;
                &lt;value&gt;True&lt;/value&gt;
            &lt;/setting&gt;
            
            &lt;setting name="Username" serializeAs="String"&gt;
                &lt;value /&gt;
            &lt;/setting&gt;
            
            &lt;setting name="Password" serializeAs="String"&gt;
                &lt;value /&gt;
            &lt;/setting&gt;
            
        &lt;!-- Filter settings --&gt;
        &lt;!-- From how long from the past we want to report entries? 
        This setting should match the schedule, i.e. if you send the report every hour, you should set the time limit to 1:00:00, or one hour --&gt;
            &lt;setting name="TimeLimitFilter" serializeAs="String"&gt;
                &lt;value&gt;1.00:00:00&lt;/value&gt; &lt;!-- reports entries from the past 24 hours --&gt;
            &lt;/setting&gt;
            
        &lt;!--  The maximum number of messages to include in a report 
        200 by default if you don't give anything. To return all, set this to 0 --&gt;
            &lt;setting name="MaxMessages" serializeAs="String"&gt;
            &lt;value&gt;200&lt;/value&gt; 
            &lt;/setting&gt;
            
        &lt;!-- The filter string. If empty, all entries will be reported --&gt;
            &lt;setting name="FilterString" serializeAs="String"&gt;
                &lt;value&gt;EntryType = "Error"&lt;/value&gt; &lt;!-- reports only Error entries --&gt;
            &lt;/setting&gt;

        &lt;!-- The name of the remote computer whose event log to read, if required, leave empty if local --&gt;
            &lt;setting name=&quot;RemoteMachine&quot; serializeAs=&quot;String&quot;&gt;
                &lt;value&gt;&lt;/value&gt;
            &lt;/setting&gt;

        &lt;!-- The name of the event log to read, if required. Defaults to Application when left empty --&gt;
            &lt;setting name=&quot;EventLogName&quot; serializeAs=&quot;String&quot;&gt;
                &lt;value&gt;&lt;/value&gt;
            &lt;/setting&gt;
        &lt;!-- If specified the file which contains the custom template in Liquid format for the email message--&gt;
          &lt;setting name="TemplateFile" serializeAs="String"&gt;
            &lt;value /&gt;
          &lt;/setting&gt;
        &lt;!-- Should the SMTP connection use SSL --&gt;
          &lt;setting name="UseSSL" serializeAs="String"&gt;
            &lt;value&gt;False&lt;/value&gt;
          &lt;/setting&gt;
        &lt;/Frends.Radon.Properties.Settings&gt;
    &lt;/applicationSettings&gt;
&lt;/configuration&gt;
</pre>
    <h2>
        <a name="descriptions">Configuration element descriptions</a></h2>
    <h4>
        SMTP settings</h4>
    <dl>
        <dt><a name="SMTP_SmtpServerName">SmtpServerName</a></dt>
        <dd>
            Server name or IP address of host to be used for SMTP actions.</dd>
        <dt><a name="SMTP_PortNumber">PortNumber</a></dt>
        <dd>
            Port number for SMTP actions. Should be 25 by default</dd>
        <dt><a name="SMTP_MaxIdleTime">MaxIdleTime</a></dt>
        <dd>
            Sets up a time (in milliseconds), enclosed in value-tags, how long connection can
            remain idle before it is closed.</dd>
        <dt><a name="SMTP_UseWindowsCredentials">UseWindowsCredentials</a></dt>
        <dd>
            If the SMTP server requires authentication, you can use the Windows credentials
            of the account running the Radon executable by setting this parameter value to 'True'.
            On the other hand, if the server does not require authentication, you can send emails
            anonymously by setting this parameter value to 'False' and leaving <a href="#SMTP_Username">
                Username</a> parameter empty.
        <dt><a name="SMTP_Username">Username</a> -optional</dt>
        <dd>
            SMTP username for sending email. As noted above, can be left blank if you are using
            Windows credentials or anonymous authentication.
        <dt><a name="SMTP_Password">Password</a> -optional</dt>
        <dd>
            Password for SMTP user. Must be given if the Username is given - you cannot use
            an empty password for username/password authentication<br />
            <b>NOTE:</b> Password will be sent in clear text to the server.</dd>
        <dt><a name="SMTP_UseSSL">UseSSL</a></dt>
        <dd>Should the connection to the SMTP server use SSL. true/false</dd>
    </dl>
    <h4>
        Email details</h4>
    <dl>
        <dt><a name="Email_SenderAddress">SenderAddress</a></dt>
        <dd>
            Email address to be used with sent emails. <b>NOTE:</b> Some SMTP servers filter
            the sent messages based on the sender address, so make sure your server accepts
            this address</dd>
        <dt><a name="Email_SenderName">SenderName</a></dt>
        <dd>
            Display name shown as the sender name in emails.</dd>
        <dt><a name="Email_Recipients">Recipients</a></dt>
        <dd>
            Recipient(s) to whom the event report should be sent. Each recipient must be enclosed
            in separate string tags</dd>
        <dt><a name="Email_Subject">Subject</a></dt>
        <dd>
            Text to be displayed on email subject line. The accepts the same template format as the TemplateFile if more complex subjects are needed.</dd>
        <dt><a name="Email_TemplateFile">TemplateFile</a></dt>
        <dd>The path to the file which contains the Liquid template to use. The default template will be used if left empty. See <a href="#template">Template</a> for the template format.</dd>
    </dl>
    <h4>
        Filter settings</h4>
    <dl>
        <dt><a name="Filter_TimeLimitFilter">TimeLimitFilter</a></dt>
        <dd>
            From how long from the past we want to report entries? This setting should match
            the schedule, i.e. if you send the report every hour you should set the time limit
            to 1:00:00, or one hour. One hour by default.<br />
            <b>NOTE:</b> This value is parsed to a Timespan, the format is <i>d.HH:mm:ss</i></dd>
        <dt><a name="Filter_MaxMessages">MaxMessages</a></dt>
        <dd>
            The maximum number of entries to include in a report. 200 by default. To return
            all possible entries, set this to 0.</dd>
        <dt><a name="Filter_RemoteMachine">RemoteMachine</a></dt>
        <dd>
            The name of the machine whose event log will be read. Leave this empty if the target
            machine is the local machine.<br />
            <b>NOTE:</b> Reading a remote event log is <b>much</b> slower than reading a local
            event log.
            <br />
            In addition, the user account with which FRENDS Radon is run must be able to read
            the event log. To allow this, the user account needs to be added to the target computer's
            <i>Event Log Readers</i> group.</dd>
        <dt><a name="Filter_EventLogName">EventLogName</a></dt>
        <dd>
            The name of the event log which will be read, e.g. <i>Application</i> or <i>Security</i>.
            Defaults to Application if left empty.</dd>
        <dt><a name="Filter_FilterString">FilterString</a></dt>
        <dd>
            The filter string to use. See the section <a href="#filterString">Filter string</a>
            below for details and examples</dd>
        <dt><a name="Filter_EventSource">EventSource</a><dt>
        <dd>(FRENDS Iron Simple Task only) The for the events, can be the inbuilt event log reader (default) or an
        external event source. Either EventLog or External. </dd>
        <dt><a name="Filter_ExternalEventsXml">ExternalEventsXml</a><dt>
        <dd>(FRENDS Iron Simple Task only) The external events in XML format. See <a href="#externalEvents">External events</a></dd>
    </dl>
    <hr />
    <h2>
        <a name="filterString">FILTER STRINGS</a></h2>
    <p>
        The filter string can be used to choose which events are reported. If the string
        is empty, all entries will be returned.</p>
    <p>
        The filter string is essentially a simple condition string a bit like SQL WHERE
        -clause. You define the filters using entry properties and operators (<span class="filter">And,
            Or, Not, =, &gt;, &lt;, &lt;&gt;</span> etc.). All strings need to be enclosed
        in double quotation marks (<span class="filter">"</span>). For the string-valued
        properties, like <span class="filter">Message</span>, you can call methods like
        <span class="filter">Contains(), StartsWith(), EndsWith()</span> etc.</p>
    <p>
        The following table shows some examples of filter strings and what they will return.</p>
    <table>
        <thead>
            <tr>
                <th>
                    Filter
                </th>
                <th>
                    Returns
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="filter">
                    EntryType = "Error"
                </td>
                <td>
                    Entries of type Error (i.e. those entries showing the red ball with a cross in event
                    viewer)
                </td>
            </tr>
            <tr>
                <td class="filter">
                    EntryType = "Error" Or EntryType = "Warning"
                </td>
                <td>
                    Entries of type Error or Warning
                </td>
            </tr>
            <tr>
                <td class="filter">
                    EntryType = "Information"
                </td>
                <td>
                    Entries of type Information. <b>NOTE:</b> This filter will not return any Error
                    or Warning type entries see the next filter for that
                </td>
            </tr>
            <tr>
                <td class="filter">
                    ErrorLevel &gt;= 0
                </td>
                <td>
                    Entries of type Information, Warning or Error
                </td>
            </tr>
            <tr>
                <td class="filter">
                    EntryType &lt;&gt; "Information"
                </td>
                <td>
                    Entries of type other than Information. NOTE: This includes also those entries with
                    no type or the SuccessAudit/FailureAudit type
                </td>
            </tr>
            <tr>
                <td class="filter">
                    Message.Contains("foo")
                </td>
                <td>
                    Entries whose description contains the string "foo"
                </td>
            </tr>
            <tr>
                <td class="filter">
                    Not Message.Contains("foo")
                </td>
                <td>
                    Entries whose description do not contain the string "foo"
                </td>
            </tr>
            <tr>
                <td class="filter">
                    Source &lt;&gt; "BizTalk Server 2009"
                </td>
                <td>
                    Entries whose source is not "BizTalk Server 2009"
                </td>
            </tr>
            <tr>
                <td class="filter">
                    EventID = 2345
                </td>
                <td>
                    Entries with Event ID 2345
                </td>
            </tr>
            <tr>
                <td class="filter">
                    EventID &gt; 1000 And EventID &lt;= 2000
                </td>
                <td>
                    Entries with Event ID in the range of 1001 to 2000
                </td>
            </tr>
            <tr>
                <td class="filter">
                    (EventID &gt; 1000 And EventID &lt;= 2000) Or EventID = 345
                </td>
                <td>
                    Entries with Event ID either in the range of 1001 to 2000 or 345
                </td>
            </tr>
        </tbody>
    </table>
    <p>
        The table below shows the entry properties you can use in your queries.</p>
    <table>
        <thead>
            <tr>
                <th>
                    Property
                </th>
                <th>
                    Description
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="filter">
                    EntryType
                </td>
                <td>
                    The Type of the entry. Can be Error, Warning, Information, SuccessAudit or FailureAudit.
                    Note that even though the property is an enum, you cannot compare it against integers
                    - use the ErrorLevel property for that
                </td>
            </tr>
            <tr>
                <td class="filter">
                    ErrorLevel
                </td>
                <td>
                    Error level. This field is a mapping from the EntryType, and the value can be -1,
                    0 (Information), 1 (Warning), 2 (Error), 3 (SuccessAudit) or 4 (FailureAudit). ErrorLevel
                    is meant for creating simple filters that return all error and warning messages
                    (<span class="filter">ErrorLevel >= 1</span>), for instance.
                </td>
            </tr>
            <tr>
                <td class="filter">
                    Source
                </td>
                <td>
                    The Source name of the application that generated the entry, e.g. "FRENDS Helium",
                    "MSSQLSERVER" or "BizTalk Server 2009"
                </td>
            </tr>
            <tr>
                <td class="filter">
                    Message
                </td>
                <td>
                    The localized message associated with the entry
                </td>
            </tr>
            <tr>
                <td class="filter">
                    EventID
                </td>
                <td>
                    The application specific event identifier for the entry
                </td>
            </tr>
            <tr>
                <td class="filter">
                    TimeGenerated
                </td>
                <td>
                    The time the entry was generated to the log. Note that you should use the TimeLimitFilter
                    of the configuration for filtering based on time
                </td>
            </tr>
            <tr>
                <td class="filter">
                    CategoryNumber
                </td>
                <td>
                    The optional category number of the entry, if it has one defined
                </td>
            </tr>
            <tr>
                <td class="filter">
                    Category
                </td>
                <td>
                    The string describing the category of the entry, if it has the category number defined
                </td>
            </tr>
            <tr>
                <td class="filter">
                    InstanceID
                </td>
                <td>
                    The InstanceId property. It uniquely identifies an entry using the full 32-bit resource
                    identifier
                </td>
            </tr>
            <tr>
                <td class="filter">
                    Index
                </td>
                <td>
                    The index of the entry in the event log.
                </td>
            </tr>
        </tbody>
    </table>
    <hr />
    <h2><a name="template">Email templates</a></h2>
    <p>FRENDS Radon uses the <a href="http://dotliquidmarkup.org/">DotLiquid</a> library for the email templating. Both the subject and email body can be templated, the subject template is configured directly in the configuration. The body template can be provided in a file (see <a href="#Email_TemplateFile">templateFile</a>) if the default message needs to be modified. For the template markup syntax see the official <a href="https://github.com/Shopify/liquid/wiki/Liquid-for-Designers">Liquid documentation</a>.</p>
    <p>In addition to the standard filters, we have implemented a custom regex filter: match_first, with the following syntax: <pre>{{ '<i>text to match</i>' | match_first: '<i>regexp</i>'}}</pre> The Filter returns the first regexp match for the filtered string, for example 
    <pre>{{ 'FRENDS Radon' | match_first: '^FRENDS (.*)$' }}</pre> would result in: Radon</p>
    <p>The following variables are provided to the template:</p>
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Content</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>events</td>
                <td>The list of events which matched the filter. Each event has the following properties, which correspond with the fields in the event log: category_number, category, message, source, time_generated, entry_type, instance_id, index, event_id, error_level</td>
            </tr>
            <tr>
                <td>count</td>
                <td>The amount of events which matched the filter, the maximum value is limited by <a href="#Filter_MaxMessages">MaxMessages setting</a></td>
            </tr>
            <tr>
                <td>config</td>
                <td>The filter config with the following properties: filter_string, time_limit, max_messages, use_max_messages, remote_machine, event_log_name</td>
            </tr>
            <tr>
                <td>start_time</td>
                <td>The start of the time period during which the events were scanned.</td>
            </tr>
            <tr>
                <td>current_time</td>
                <td>The local time when the report was generated.</td>
            </tr>
            <tr>
                <td>machine_name</td>
                <td>The machine name for the system whose eventlog was scanned.</td>
            </tr>
            <tr>
                <td>event_log_name</td>
                <td>The name of the eventlog which was scanned.</td>
            </tr>
        </tbody>
    </table>
    <p> The default template which is used if no custom template is defined: </p>
    <pre>
{% assign bgColor1 = '#f1f1f1' %}
{% assign bgColor2 = '#f2f2f2' %}

{{ count }}{% if count &gt;= config.max_messages %} latest{% endif %} events from the {{ event_log_name }} log from {{ start_time }} to {{ current_time }} on the machine {{ machine_name }}
&lt;table border='0' cellspacing='2px' cellpadding='2'&gt;
    &lt;thead&gt;
        &lt;tr bgcolor='{{ bgColor2 }}'&gt;
            &lt;th&gt;Level&lt;/th&gt;
            &lt;th&gt;Date and Time&lt;/th&gt;
            &lt;th&gt;Source&lt;/th&gt;
            &lt;th&gt;Event ID&lt;/th&gt;
            &lt;th&gt;Category&lt;/th&gt;
            &lt;th&gt;Message&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
    {% for event in events %}
        &lt;tr bgcolor='{% cycle '#ffffff', bgcolor1 %}'&gt;
            &lt;td&gt;{{ event.entry_type }}&lt;/td&gt;
            &lt;td&gt;{{ event.time_generated }}&lt;/td&gt;
            &lt;td&gt;{{ event.source }}&lt;/td&gt;
            &lt;td&gt;{{ event.event_id }}&lt;/td&gt;
            &lt;td&gt;{{ event.category }}&lt;/td&gt;
            &lt;td&gt;{{ event.message | escape }}&lt;/td&gt;
        &lt;/tr&gt;
    {% endfor %}    
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Filter used: &lt;pre&gt;{{ config.filter_string }}&lt;/pre&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;This report was generated by FRENDS Radon ( &lt;a href=\'http://www.frends.com\'&gt;Frends Technology&lt;/a&gt; )&lt;/p&gt;
    </pre>
    <hr />
    <h2><a name="externalEvents">External events</a></h2>
    <p>The Simple Task version of FRENDS Radon supports the option of providing the events from an external source. In most cases this would
    be a previous Task in the same Routine, in which case the events can be referenced with the {PreviousTask:Output} reference. The Previous Task refence is supported by FRENDS Iron versions 3.4 and later. It should be noted the settings for external events are not available in the Connection Point, but only in the Routine Task settings.</p>
    <p>
    The event data must be in the following XML-format:
    </p>
    <pre>
&lt;Events&gt;
    &lt;Event&gt;
        &lt;Message&gt;Performance counters for the WmiApRpl (WmiApRpl) service were loaded successfully. The Record Data in the data section contains the new index values assigned to this service.&lt;/Message&gt;
        &lt;Source&gt;Microsoft-Windows-LoadPerf&lt;/Source&gt;
        &lt;TimeGenerated&gt;2014-10-14 13:59:09Z&lt;/TimeGenerated&gt;
        &lt;Category&gt;(0)&lt;/Category&gt;
        &lt;EventID&gt;1000&lt;/EventID&gt;
        &lt;CategoryNumber&gt;0&lt;/CategoryNumber&gt;
        &lt;Index&gt;197340&lt;/Index&gt;
        &lt;ErrorLevel&gt;0&lt;/ErrorLevel&gt;
        &lt;InstanceID&gt;1000&lt;/InstanceID&gt;
        &lt;EntryType&gt;Information&lt;/EntryType&gt;
    &lt;/Event&gt;
    &lt;Event&gt;
        &lt;Message&gt;The description for Event ID '1073742831' in Source 'Customer Experience Improvement Program' cannot be found.  The local computer may not have the necessary registry information or message DLL files to display the message, or you may not have permission to access them.  The following information is part of the event:&lt;/Message&gt;
        &lt;Source&gt;Customer Experience Improvement Program&lt;/Source&gt;
        &lt;TimeGenerated&gt;2014-10-14 13:50:08Z&lt;/TimeGenerated&gt;
        &lt;Category&gt;(0)&lt;/Category&gt;
        &lt;EventID&gt;1007&lt;/EventID&gt;
        &lt;CategoryNumber&gt;0&lt;/CategoryNumber&gt;
        &lt;Index&gt;197338&lt;/Index&gt;
        &lt;ErrorLevel&gt;0&lt;/ErrorLevel&gt;
        &lt;InstanceID&gt;1073742831&lt;/InstanceID&gt;
        &lt;EntryType&gt;Information&lt;/EntryType&gt;
    &lt;/Event&gt;
&lt;/Events&gt;
    </pre>
    <p>When using external events, FRENDS Radon does not enforce the time limit 'maxTimespan' for the events, although previously reported events are still filtered out. This means that the TimeGenerated needs to be set to a non-null value.</p>
    <hr />
    <h2><a name="mailer">Mailer</a></h2>
    <p>
    The FRENDS Radon mailing functionality is provided as the Simple Task 'FRENDS Radon Mailer', which can be used to send arbitrary email messages. The Mailer task uses the same email settings as the FRENDS Radon Simple Task except it does not support the <a href="#template">email templates</a>. Instead of the template, it has the 'MessageContent' property which can be used to set the email message body.
    </p>
</body>
</html>
